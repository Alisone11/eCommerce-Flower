"use strict";(self["webpackChunkfinalproject"]=self["webpackChunkfinalproject"]||[]).push([[274],{274:function(t,e,s){s.r(e),s.d(e,{default:function(){return I}});var o=s(3396),a=s(9242),i=s(7139);const l={class:"table"},n=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{scope:"col",width:"200"},"圖片"),(0,o._)("th",{scope:"col"},"產品名稱"),(0,o._)("th",{scope:"col",width:"100"},"數量"),(0,o._)("th",{scope:"col",width:"150"},"單價"),(0,o._)("th",{scope:"col"})])],-1),c=["onClick"],r={class:"input-group input-group-sm"},u=["disabled","onChange","onUpdate:modelValue"],d={class:"input-group-text"},p={class:"text-end"},h=["onClick"],g=(0,o._)("i",{class:"bi bi-x-circle"},null,-1),_=[g],C={colspan:"3"},f=(0,o._)("p",{class:"fw-bold text-end"},"小計",-1),b={key:0,class:"text-end"},x={class:"bg-success text-light p-1 rounded"},m={class:"fw-bold"},w=(0,o._)("span",{class:"fw-bold ms-2 text-success"},"折抵",-1),v=(0,o._)("p",{class:"fw-bold text-end"},"總額",-1),y={class:"text-end"},k={key:0,class:"fw-bold text-end text-success"},$={class:"text-end"},L={class:"input-group input-group-sm"},z={class:"input-group-text"},q={class:"text-end"};function M(t,e,s,g,M,j){const D=(0,o.up)("LoadingCom");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(D,{active:M.isLoading},null,8,["active"]),(0,o._)("table",l,[n,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(M.carts,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id},[(0,o._)("td",null,[(0,o._)("a",{href:"javascript:;",onClick:(0,a.iM)((t=>j.getProduct(e.product.id)),["prevent"])},[(0,o._)("div",{style:(0,i.j5)([{backgroundImage:`url(${e.product.imageUrl})`},{height:"150px"}]),class:"bg-center"},null,4)],8,c)]),(0,o._)("td",null,(0,i.zw)(e.product.title),1),(0,o._)("td",null,[(0,o._)("div",r,[(0,o.wy)((0,o._)("input",{type:"number",class:"form-control",min:"1",disabled:e.id===M.loadingItem,onChange:t=>j.updateCart(e),"onUpdate:modelValue":t=>e.qty=t},null,40,u),[[a.nr,e.qty,void 0,{number:!0}]]),(0,o._)("div",d,"/ "+(0,i.zw)(e.product.unit),1)])]),(0,o._)("td",p,[(0,o._)("p",null,(0,i.zw)(t.$filters.currency(e.product.price)),1)]),(0,o._)("td",null,[(0,o._)("a",{href:"javascript:;",class:"text-danger h5",onClick:(0,a.iM)((t=>j.delCart(e)),["prevent"])},_,8,h)])])))),128))]),(0,o._)("tfoot",null,[(0,o._)("tr",null,[(0,o._)("td",C,[f,M.cart.final_total!==M.cart.total?((0,o.wg)(),(0,o.iD)("p",b,[(0,o._)("span",x,[(0,o.Uk)("已套用優惠券: "),(0,o._)("span",m,(0,i.zw)(M.carts[0].coupon.title),1)]),w])):(0,o.kq)("",!0),v]),(0,o._)("td",null,[(0,o._)("p",y,(0,i.zw)(t.$filters.currency(M.cart.total)),1),M.cart.final_total!==M.cart.total?((0,o.wg)(),(0,o.iD)("p",k,"- "+(0,i.zw)(t.$filters.currency(M.cart.total-M.cart.final_total)),1)):(0,o.kq)("",!0),(0,o._)("p",$,(0,i.zw)(t.$filters.currency(M.cart.final_total)),1)])])])]),(0,o._)("div",L,[(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[0]||(e[0]=t=>M.code=t),onKeyup:e[1]||(e[1]=(0,a.D2)(((...t)=>j.useCoupon&&j.useCoupon(...t)),["enter"]))},null,544),[[a.nr,M.code,void 0,{lazy:!0}]]),(0,o._)("div",z,[(0,o._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=(0,a.iM)(((...t)=>j.useCoupon&&j.useCoupon(...t)),["prevent"]))}," 套用優惠碼 ")])]),(0,o._)("div",q,[(0,o._)("button",{class:"btn btn-primary text-light mt-4",onClick:e[3]||(e[3]=(0,a.iM)(((...t)=>j.goCheckout&&j.goCheckout(...t)),["prevent"]))},"前往結帳")])],64)}s(7658);var j={data(){return{carts:[],cart:{},isLoading:!1,loadingItem:"",code:""}},created(){this.getCarts()},methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/alisonhu-api/cart";this.axios.get(t).then((t=>{console.log("getCarts",t),this.isLoading=!1,this.carts=t.data.data.carts,this.cart=t.data.data}))},getProduct(t){this.$router.push(`/user/product/${t}`)},delCart(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/cart/${t.id}`;this.axios.delete(e).then((t=>{console.log("delCart",t),this.isLoading=!1,this.getCarts(),this.PushMessageState(t,"刪除"),this.emitter.emit("cart-qty")}))},updateCart(t){this.loadingItem=t.id;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/cart/${t.id}`,s={product_id:t.id,qty:t.qty};this.axios.put(e,{data:s}).then((t=>{console.log("UpdateCart",t),this.loadingItem="",this.getCarts()}))},useCoupon(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/alisonhu-api/coupon",e={code:this.code};this.axios.post(t,{data:e}).then((t=>{console.log("useCoupon",t),this.isLoading=!1,this.getCarts(),this.PushMessageState(t,"套用優惠券")}))},goCheckout(){this.$router.push("/user/info")}},inject:["emitter","PushMessageState"]},D=s(89);const U=(0,D.Z)(j,[["render",M]]);var I=U}}]);
//# sourceMappingURL=274.8deda182.js.map