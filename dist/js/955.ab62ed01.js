"use strict";(self["webpackChunkfinalproject"]=self["webpackChunkfinalproject"]||[]).push([[955],{2955:function(t,e,s){s.r(e),s.d(e,{default:function(){return P}});var a=s(3396),o=s(9242),i=s(7139);const n={class:"table"},l=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col",width:"200"},"圖片"),(0,a._)("th",{scope:"col"},"產品名稱"),(0,a._)("th",{scope:"col",width:"100"},"數量"),(0,a._)("th",{scope:"col",width:"150"},"單價"),(0,a._)("th",{scope:"col"})])],-1),c=["onClick"],r={class:"input-group input-group-sm"},u=["disabled","onChange","onUpdate:modelValue"],d={class:"input-group-text"},p={class:"text-end"},h=["onClick"],g=(0,a._)("i",{class:"bi bi-x-circle"},null,-1),_=[g],C={colspan:"3"},f=(0,a._)("p",{class:"fw-bold text-end"},"小計",-1),b={key:0,class:"text-end"},x={class:"bg-success text-light p-1 rounded"},m={class:"fw-bold"},w=(0,a._)("span",{class:"fw-bold ms-2 text-success"},"折抵",-1),v=(0,a._)("p",{class:"fw-bold text-end"},"總額",-1),y={class:"text-end"},k={key:0,class:"fw-bold text-end text-success"},$={class:"text-end"},L={class:"input-group input-group-sm"},z={class:"input-group-text"},q={class:"text-end"};function M(t,e,s,g,M,j){const D=(0,a.up)("LoadingCom");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(D,{active:M.isLoading},null,8,["active"]),(0,a._)("table",n,[l,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(M.carts,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,[(0,a._)("a",{href:"javascript:;",onClick:(0,o.iM)((t=>j.getProduct(e.product.id)),["prevent"])},[(0,a._)("div",{style:(0,i.j5)([{backgroundImage:`url(${e.product.imageUrl})`},{height:"150px"}]),class:"bg-center"},null,4)],8,c)]),(0,a._)("td",null,(0,i.zw)(e.product.title),1),(0,a._)("td",null,[(0,a._)("div",r,[(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",min:"1",disabled:e.id===M.loadingItem,onChange:t=>j.updateCart(e),"onUpdate:modelValue":t=>e.qty=t},null,40,u),[[o.nr,e.qty,void 0,{number:!0}]]),(0,a._)("div",d,"/ "+(0,i.zw)(e.product.unit),1)])]),(0,a._)("td",p,[(0,a._)("p",null,(0,i.zw)(t.$filters.currency(e.product.price)),1)]),(0,a._)("td",null,[(0,a._)("a",{href:"javascript:;",class:"text-danger h5",onClick:(0,o.iM)((t=>j.delCart(e)),["prevent"])},_,8,h)])])))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[(0,a._)("td",C,[f,M.cart.final_total!==M.cart.total?((0,a.wg)(),(0,a.iD)("p",b,[(0,a._)("span",x,[(0,a.Uk)("已套用優惠券: "),(0,a._)("span",m,(0,i.zw)(M.carts[0].coupon.title),1)]),w])):(0,a.kq)("",!0),v]),(0,a._)("td",null,[(0,a._)("p",y,(0,i.zw)(t.$filters.currency(M.cart.total)),1),M.cart.final_total!==M.cart.total?((0,a.wg)(),(0,a.iD)("p",k,"- "+(0,i.zw)(t.$filters.currency(M.cart.total-M.cart.final_total)),1)):(0,a.kq)("",!0),(0,a._)("p",$,(0,i.zw)(t.$filters.currency(M.cart.final_total)),1)])])])]),(0,a._)("div",L,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[0]||(e[0]=t=>M.code=t),onKeyup:e[1]||(e[1]=(0,o.D2)(((...t)=>j.useCoupon&&j.useCoupon(...t)),["enter"]))},null,544),[[o.nr,M.code,void 0,{lazy:!0}]]),(0,a._)("div",z,[(0,a._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=(0,o.iM)(((...t)=>j.useCoupon&&j.useCoupon(...t)),["prevent"]))}," 套用優惠碼 ")])]),(0,a._)("div",q,[(0,a._)("button",{class:"btn btn-primary text-light mt-4",onClick:e[3]||(e[3]=(0,o.iM)(((...t)=>j.goCheckout&&j.goCheckout(...t)),["prevent"]))},"前往結帳")])],64)}s(7658);var j={data(){return{carts:[],cart:{},isLoading:!1,loadingItem:"",code:""}},created(){this.getCarts()},methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/alisonhu-api/cart";this.axios.get(t).then((t=>{this.isLoading=!1,this.carts=t.data.data.carts,this.cart=t.data.data}))},getProduct(t){this.$router.push(`/user/product/${t}`)},delCart(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/cart/${t.id}`;this.axios.delete(e).then((t=>{this.isLoading=!1,this.getCarts(),this.PushMessageState(t,"刪除"),this.emitter.emit("cart-qty")}))},updateCart(t){this.loadingItem=t.id;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/cart/${t.id}`,s={product_id:t.id,qty:t.qty};this.axios.put(e,{data:s}).then((t=>{this.loadingItem="",this.getCarts()}))},useCoupon(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/alisonhu-api/coupon",e={code:this.code};this.axios.post(t,{data:e}).then((t=>{this.isLoading=!1,this.getCarts(),this.PushMessageState(t,"套用優惠券")}))},goCheckout(){this.$router.push("/user/info")}},inject:["emitter","PushMessageState"]},D=s(89);const I=(0,D.Z)(j,[["render",M]]);var P=I}}]);
//# sourceMappingURL=955.ab62ed01.js.map