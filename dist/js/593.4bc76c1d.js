"use strict";(self["webpackChunkfinalproject"]=self["webpackChunkfinalproject"]||[]).push([[593],{143:function(t,e,l){l.r(e),l.d(e,{default:function(){return Gt}});var s=l(3396),a=l(9242),o=l(7139);const i={class:"d-flex justify-content-between"},c=(0,s._)("h3",null,"商品",-1),d={class:"d-flex"},n={class:"me-3"},r={class:"input-group"},u=["value"],p=(0,s._)("button",{class:"btn btn-secondary input-group-text",type:"submit"},[(0,s._)("i",{class:"bi bi-search"})],-1),m={class:"text-end"},h={class:"bg-light border rounded mt-3 shadow"},b={class:"table mt-4"},g=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{width:"100"},"圖片"),(0,s._)("th",{width:"150"},"商品名稱"),(0,s._)("th",{width:"100"},"原價"),(0,s._)("th",{width:"100"},"售價"),(0,s._)("th",{width:"120"},"是否啟用"),(0,s._)("th",{width:"150"},"編輯")])],-1),_={class:"form-check form-switch"},f=["onUpdate:modelValue"],v={class:"form-check-label",for:"flexSwitchCheckChecked"},y={class:"btn-group"},w=["onClick"],P=["onClick"];function x(t,e,l,x,M,k){const U=(0,s.up)("LoadingCom"),C=(0,s.up)("ProductsModal"),I=(0,s.up)("DelModal"),$=(0,s.up)("PaginationCom");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(U,{active:M.isLoading},null,8,["active"]),(0,s._)("div",i,[c,(0,s._)("div",d,[(0,s._)("form",n,[(0,s._)("div",r,[(0,s._)("input",{class:"form-control form-control-sm",type:"search",placeholder:"請輸入商品名稱",value:M.searchInput,onChange:e[0]||(e[0]=t=>M.searchInput=t.target.value),"aria-label":"Search"},null,40,u),p])]),(0,s._)("div",m,[(0,s._)("button",{class:"btn btn-primary text-white",type:"button",onClick:e[1]||(e[1]=(0,a.iM)((t=>k.openModal(!0)),["prevent"]))},"新增商品")])])]),(0,s._)("div",h,[(0,s._)("table",b,[g,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.searchData,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",null,[(0,s._)("div",{style:(0,o.j5)([{backgroundImage:`url(${e.imageUrl})`},{height:"50px"}]),class:"bg-center"},null,4)]),(0,s._)("td",null,(0,o.zw)(e.title),1),(0,s._)("td",null,(0,o.zw)(t.$filters.currency(e.origin_price)),1),(0,s._)("td",null,(0,o.zw)(t.$filters.currency(e.price)),1),(0,s._)("td",null,[(0,s._)("div",_,[(0,s.wy)((0,s._)("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"flexSwitchCheckChecked","onUpdate:modelValue":t=>e.is_enabled=t},null,8,f),[[a.e8,e.is_enabled]]),(0,s._)("label",v,(0,o.zw)(e.is_enabled?"啟用":"未啟用"),1)])]),(0,s._)("td",null,[(0,s._)("div",y,[(0,s._)("button",{class:"btn btn-outline-primary btn-sm",onClick:(0,a.iM)((t=>k.openModal(!1,e)),["prevent"])},"編輯",8,w),(0,s._)("button",{class:"btn btn-outline-danger btn-sm",onClick:(0,a.iM)((t=>k.delModal(e)),["prevent"])},"刪除",8,P)])])])))),128))])])]),(0,s.Wm)(C,{ref:"productModal",product:M.tempProduct,onUpdateProduct:k.updateProduct},null,8,["product","onUpdateProduct"]),(0,s.Wm)(I,{ref:"delModal",item:M.tempProduct,onDelItem:k.delItem},null,8,["item","onDelItem"]),M.searchInput?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)($,{key:0,pages:M.pagination,onUpdatePage:k.getProducts},null,8,["pages","onUpdatePage"]))],64)}const M={class:"modal",tabindex:"-1",ref:"modal"},k={class:"modal-dialog modal-xl",role:"document"},U={class:"modal-content border-0"},C=(0,s._)("div",{class:"modal-header bg-primary text-white"},[(0,s._)("h4",{class:"modal-title",id:"exampleModalLabel"},"產品"),(0,s._)("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={class:"modal-body"},$={class:"row"},D={class:"col-sm-4"},L={class:"mb-3"},V=(0,s._)("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),j={type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結",ref:"fileInput"},z={class:"mb-3"},F=(0,s._)("label",{for:"customFile",class:"form-label"},"或 上傳圖片 ",-1),S={type:"file",id:"customFile",class:"form-control",ref:"fileInput2"},Z={class:"text-danger"},A={class:"btn-group",role:"group","aria-label":"Basic example"},H={key:0,class:"mt-3"},N={class:"d-flex justify-content-between"},W=(0,s._)("h6",{class:"text-primary"},"主圖",-1),Y=["src"],q={class:"d-flex justify-content-between"},K={class:"text-primary"},O=["onClick"],B=["src"],E={class:"col-sm-8"},G={class:"mb-3"},J=(0,s._)("label",{for:"title",class:"form-label"},"標題",-1),Q={class:"row gx-2"},R={class:"mb-3 col-md-6"},T=(0,s._)("label",{for:"category",class:"form-label"},"分類",-1),X=(0,s._)("option",{disabled:""},"請輸入分類",-1),tt=(0,s._)("option",{value:"plants"},"植栽",-1),et=(0,s._)("option",{value:"flowers"},"乾燥花",-1),lt=[X,tt,et],st={class:"mb-3 col-md-6"},at=(0,s._)("label",{for:"unit",class:"form-label"},"單位",-1),ot=(0,s._)("option",{value:"",selected:"",disabled:""},"請輸入單位",-1),it=(0,s._)("option",{value:"盆"},"盆",-1),ct=(0,s._)("option",{value:"束"},"束",-1),dt=[ot,it,ct],nt={class:"row gx-2"},rt={class:"mb-3 col-md-6"},ut=(0,s._)("label",{for:"origin_price",class:"form-label"},"原價",-1),pt={class:"mb-3 col-md-6"},mt=(0,s._)("label",{for:"price",class:"form-label"},"售價",-1),ht=(0,s._)("hr",null,null,-1),bt={class:"mb-3"},gt=(0,s._)("label",{for:"description",class:"form-label"},"產品描述",-1),_t={class:"mb-3"},ft=(0,s._)("label",{for:"content",class:"form-label"},"說明內容",-1),vt={class:"mb-3"},yt={class:"form-check"},wt=(0,s._)("label",{class:"form-check-label",for:"is_gift"},"是否為送禮首選",-1),Pt={class:"mb-3"},xt={class:"form-check"},Mt=(0,s._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),kt={class:"modal-footer"},Ut=(0,s._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function Ct(t,e,l,i,c,d){return(0,s.wg)(),(0,s.iD)("div",M,[(0,s._)("div",k,[(0,s._)("div",U,[C,(0,s._)("div",I,[(0,s._)("div",$,[(0,s._)("div",D,[(0,s._)("div",L,[V,(0,s._)("input",j,null,512)]),(0,s._)("div",z,[F,(0,s._)("input",S,null,512),(0,s._)("p",Z,(0,o.zw)(c.wrongMessage),1)]),(0,s._)("div",A,[(0,s._)("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:e[0]||(e[0]=(0,a.iM)((t=>d.upload(!0)),["prevent"]))},"設為主圖"),(0,s._)("button",{type:"button",class:"btn btn-sm btn-outline-secondary",onClick:e[1]||(e[1]=(0,a.iM)((t=>d.upload(!1)),["prevent"]))},"加入其他圖片")]),c.tempProduct.imageUrl?((0,s.wg)(),(0,s.iD)("div",H,[(0,s._)("div",N,[W,(0,s._)("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:e[2]||(e[2]=t=>c.tempProduct.imageUrl="")},"移除")]),(0,s._)("img",{class:"img-fluid mt-2",src:c.tempProduct.imageUrl,alt:"img"},null,8,Y)])):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.tempProduct.imagesUrl,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{key:t+`${e}`,class:"mt-3"},[(0,s._)("div",q,[(0,s._)("h6",K,"圖片 "+(0,o.zw)(e+1),1),(0,s._)("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:t=>c.tempProduct.imagesUrl.splice(e,1)},"移除",8,O)]),(0,s._)("img",{class:"img-fluid mt-2 w-75",src:t,alt:"img"},null,8,B)])))),128))]),(0,s._)("div",E,[(0,s._)("div",G,[J,(0,s.wy)((0,s._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":e[3]||(e[3]=t=>c.tempProduct.title=t)},null,512),[[a.nr,c.tempProduct.title]])]),(0,s._)("div",Q,[(0,s._)("div",R,[T,(0,s.wy)((0,s._)("select",{name:"category",class:"form-select",id:"category","onUpdate:modelValue":e[4]||(e[4]=t=>c.tempProduct.category=t)},lt,512),[[a.bM,c.tempProduct.category]])]),(0,s._)("div",st,[at,(0,s.wy)((0,s._)("select",{class:"form-select",id:"unit","onUpdate:modelValue":e[5]||(e[5]=t=>c.tempProduct.unit=t)},dt,512),[[a.bM,c.tempProduct.unit]])])]),(0,s._)("div",nt,[(0,s._)("div",rt,[ut,(0,s.wy)((0,s._)("input",{type:"number",class:"form-control",id:"origin_price",min:"1",placeholder:"請輸入原價","onUpdate:modelValue":e[6]||(e[6]=t=>c.tempProduct.origin_price=t)},null,512),[[a.nr,c.tempProduct.origin_price]])]),(0,s._)("div",pt,[mt,(0,s.wy)((0,s._)("input",{type:"number",class:"form-control",id:"price",min:"1",placeholder:"請輸入售價","onUpdate:modelValue":e[7]||(e[7]=t=>c.tempProduct.price=t)},null,512),[[a.nr,c.tempProduct.price]])])]),ht,(0,s._)("div",bt,[gt,(0,s.wy)((0,s._)("textarea",{type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述","onUpdate:modelValue":e[8]||(e[8]=t=>c.tempProduct.description=t)},null,512),[[a.nr,c.tempProduct.description]])]),(0,s._)("div",_t,[ft,(0,s.wy)((0,s._)("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容","onUpdate:modelValue":e[9]||(e[9]=t=>c.tempProduct.content=t)},null,512),[[a.nr,c.tempProduct.content]])]),(0,s._)("div",vt,[(0,s._)("div",yt,[(0,s.wy)((0,s._)("input",{class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,id:"is_gift","onUpdate:modelValue":e[10]||(e[10]=t=>c.tempProduct.is_gift=t)},null,512),[[a.e8,c.tempProduct.is_gift]]),wt])]),(0,s._)("div",Pt,[(0,s._)("div",xt,[(0,s.wy)((0,s._)("input",{class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,id:"is_enabled","onUpdate:modelValue":e[11]||(e[11]=t=>c.tempProduct.is_enabled=t)},null,512),[[a.e8,c.tempProduct.is_enabled]]),Mt])])])])]),(0,s._)("div",kt,[Ut,(0,s._)("button",{type:"button",class:"btn btn-outline-primary",onClick:e[12]||(e[12]=(0,a.iM)((e=>t.$emit("update-product",c.tempProduct)),["prevent"]))},"確認")])])])],512)}l(7658);var It=l(5741),$t={data(){return{tempProduct:{},wrongMessage:"",mainImg:!0}},props:{product:{type:Object,default(){return{}}}},watch:{product(){this.product.imagesUrl?this.tempProduct=this.product:this.tempProduct={...this.product,imagesUrl:[]}}},emits:["update-product"],methods:{upload(t){this.wrongMessage="";const e=this.$refs.fileInput.value,l=this.$refs.fileInput2.files[0];this.tempProduct.imagesUrl.length>1&&!1===t?this.wrongMessage="其他圖片最多只能上傳 2 張":e&&!l?(t?this.tempProduct.imageUrl=e:this.tempProduct.imagesUrl.push(e),this.$refs.fileInput.value=""):!e&&l?this.uploadFile(t,l):this.wrongMessage="上傳失敗，請指定一種上傳方式"},uploadFile(t,e){const l=new FormData;l.append("file-to-upload",e);const s="https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/upload";this.axios.post(s,l).then((e=>{console.log("uploadFile",e.data),e.data.success&&!0===t?this.tempProduct.imageUrl=e.data.imageUrl:e.data.success&&!1===t?this.tempProduct.imagesUrl.push(e.data.imageUrl):this.wrongMessage=e.data.message.message})),this.$refs.fileInput2.value=""}},mixins:[It.Z]},Dt=l(89);const Lt=(0,Dt.Z)($t,[["render",Ct]]);var Vt=Lt;const jt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},zt={class:"modal-dialog"},Ft={class:"modal-content"},St=(0,s._)("div",{class:"modal-header bg-primary text-white"},[(0,s._)("h5",{class:"modal-title",id:"exampleModalLabel"},"刪除產品"),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Zt={class:"modal-body"},At={class:"text-danger"},Ht={class:"modal-footer"},Nt=(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function Wt(t,e,l,a,i,c){return(0,s.wg)(),(0,s.iD)("div",jt,[(0,s._)("div",zt,[(0,s._)("div",Ft,[St,(0,s._)("div",Zt,[(0,s.Uk)(" 請確認是否刪除產品 "),(0,s._)("span",At,(0,o.zw)(l.item.title),1),(0,s.Uk)("，刪除後將無法復原。 ")]),(0,s._)("div",Ht,[Nt,(0,s._)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=e=>t.$emit("del-item",l.item))},"確認")])])])],512)}var Yt={props:{item:{}},emits:["del-item"],mixins:[It.Z]};const qt=(0,Dt.Z)(Yt,[["render",Wt]]);var Kt=qt,Ot=l(2307),Bt={data(){return{allProducts:[],products:[],pagination:{total_pages:""},tempProduct:{},isNew:!1,isLoading:!1,searchInput:""}},created(){this.getProducts(),this.getAllProducts(),this.searchInput=""},mounted(){this.emitter.emit("products",this.products)},methods:{getProducts(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/products?page=${t}`;this.axios.get(e).then((t=>{console.log("getProducts",t),this.isLoading=!1,this.products=t.data.products,this.pagination=t.data.pagination}))},openModal(t,e){this.tempProduct=t?{}:{...e},this.isNew=t,this.$refs.productModal.showModal(),this.$refs.productModal.wrongMessage=""},updateProduct(t){this.isLoading=!0,this.tempProduct=t;let e="https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/product",l="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/product/${t.id}`,l="put"),this.axios[l](e,{data:this.tempProduct}).then((t=>{this.isLoading=!1,console.log(t),this.$refs.productModal.hideModal(),this.getProducts(this.pagination.current_page),this.PushMessageState(t,"更新")}))},delModal(t){this.tempProduct={...t},this.$refs.delModal.showModal()},delItem(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/product/${t.id}`;this.axios.delete(e).then((t=>{this.isLoading=!1,console.log(t),this.$refs.delModal.hideModal(),this.getProducts(this.pagination.current_page),this.PushMessageState(t,"刪除")}))},getAllProducts(){const t="https://vue3-course-api.hexschool.io/api/alisonhu-api/admin/products/all";this.axios.get(t).then((t=>{console.log("getAllProducts",t),this.allProducts=Object.values(t.data.products)}))}},computed:{searchData(){let t=[];return this.searchInput?(console.log("a"),t=this.allProducts.filter((t=>t.title.match(this.searchInput)))):t=this.products,t}},components:{ProductsModal:Vt,DelModal:Kt,PaginationCom:Ot.Z},inject:["emitter","PushMessageState"]};const Et=(0,Dt.Z)(Bt,[["render",x]]);var Gt=Et}}]);
//# sourceMappingURL=593.4bc76c1d.js.map